<style>
	li:hover {
		cursor: move;
	}
</style>
<input type="button" id="create" value="Create new item">
<div id="list"></div>

<script>
		$(() => {
			$.ajax({
				url: 'src/api/get.php',
				type: 'get',
				success: response => {
					let html = '';
					html += '<ul id="items">';
					$.each(JSON.parse(response), (key, data) => {
						html += '<li class="item">';
						html += '<a class="edit" href data-id="' + data._id.$oid +'">Edit</a>&nbsp';
						html += '<a class="delete" href data-id="' + data._id.$oid +'">Delete</a>&nbsp';
						html += '<span>' + data.description + '</span>';
						html += '</li>';
					});
					html += '</ul>';
					$('#list').html(html);

					let items = $('#items');
					items.sortable({
						update: (event, ui) => {
							let list = [];
							$('#items li').each((idx, elem) => {
								list[idx] = $(elem).html();
							});

							//SAVE ITEMS HERE!
						}
					});

					items.disableSelection();

					$('#create').click(() => {
						let url = 'pages/item.php';
						url += '?_=' + (new Date()).getTime();
						$('#content').load(url);
					});

					$('a.edit').click(function(){
						let url = 'pages/item.php';
						url += '?_=' + (new Date()).getTime();
						url += '&id=' + $(this).data('id');
						$('#content').load(url);
						return false;
					});

					$('a.delete').click(function(){
						$.ajax({
							url: 'src/api/delete.php',
							type: 'post',
							data: {
								id:$(this).data('id')
							},
							success: response => {
								let url = 'pages/list.html';
								url += '?_=' + (new Date()).getTime();
								$('#content').load(url);
							},
							error: (xhr, status, error) => {

							}
						});
						return false;
					});
				},
				error: (xhr, status, error) => {
					let errorMsg = 'Request failed';
					$('#content').html(errorMsg);
				}
			});
		});
</script>